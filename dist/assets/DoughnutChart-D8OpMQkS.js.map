{"version":3,"file":"DoughnutChart-D8OpMQkS.js","sources":["../../src/apps/mosaic/src/charts/DoughnutChart.vue"],"sourcesContent":["<template>\n  <div class=\"grow flex flex-col justify-center\">\n    <div>\n      <canvas ref=\"canvas\" :data=\"data\" :width=\"width\" :height=\"height\"></canvas>\n    </div>\n    <div class=\"px-5 pt-2 pb-6\">\n      <ul ref=\"legend\" class=\"flex flex-wrap justify-center -m-1\"></ul>\n    </div>\n  </div>  \n</template>\n\n<script>\nimport { ref, watch, onMounted, onUnmounted } from 'vue'\nimport { useDark } from '@vueuse/core'\nimport { chartColors } from './ChartjsConfig'\n\nimport {\n  Chart, DoughnutController, ArcElement, TimeScale, Tooltip,\n} from 'chart.js'\nimport 'chartjs-adapter-moment'\n\n// Import utilities\nimport { tailwindConfig } from '../utils/Utils'\n\nChart.register(DoughnutController, ArcElement, TimeScale, Tooltip)\n\nexport default {\n  name: 'DoughnutChart',\n  props: ['data', 'width', 'height'],\n  setup(props) {\n\n    const canvas = ref(null)\n    const legend = ref(null)\n    let chart = null\n    const darkMode = useDark()\n    const { tooltipTitleColor, tooltipBodyColor, tooltipBgColor, tooltipBorderColor } = chartColors\n    \n    onMounted(() => {\n      const ctx = canvas.value\n      chart = new Chart(ctx, {\n        type: 'doughnut',\n        data: props.data,\n        options: {\n          cutout: '80%',\n          layout: {\n            padding: 24,\n          },\n          plugins: {\n            legend: {\n              display: false,\n            },\n            tooltip: {\n              titleColor: darkMode.value ? tooltipTitleColor.dark : tooltipTitleColor.light,\n              bodyColor: darkMode.value ? tooltipBodyColor.dark : tooltipBodyColor.light,\n              backgroundColor: darkMode.value ? tooltipBgColor.dark : tooltipBgColor.light,\n              borderColor: darkMode.value ? tooltipBorderColor.dark : tooltipBorderColor.light,\n            },            \n          },\n          interaction: {\n            intersect: false,\n            mode: 'nearest',\n          },\n          animation: {\n            duration: 500,\n          },\n          maintainAspectRatio: false,\n          resizeDelay: 200,\n        },\n        plugins: [{\n          id: 'htmlLegend',\n          afterUpdate(c, args, options) {\n            const ul = legend.value\n            if (!ul) return\n            // Remove old legend items\n            while (ul.firstChild) {\n              ul.firstChild.remove()\n            }\n            // Reuse the built-in legendItems generator\n            const items = c.options.plugins.legend.labels.generateLabels(c)\n            items.forEach((item) => {\n              const li = document.createElement('li')\n              li.style.margin = tailwindConfig().theme.margin[1]\n              // Button element\n              const button = document.createElement('button')\n              button.classList.add('btn-xs', 'bg-white', 'dark:bg-slate-800', 'text-slate-500', 'dark:text-slate-400', 'border', 'border-slate-200', 'dark:border-slate-700', 'shadow-md')\n              button.style.opacity = item.hidden ? '.3' : ''\n              button.onclick = () => {\n                c.toggleDataVisibility(item.index, !item.index)\n                c.update()\n              }\n              // Color box\n              const box = document.createElement('span')\n              box.style.display = 'block'\n              box.style.width = tailwindConfig().theme.width[2]\n              box.style.height = tailwindConfig().theme.height[2]\n              box.style.backgroundColor = item.fillStyle\n              box.style.borderRadius = tailwindConfig().theme.borderRadius.sm\n              box.style.marginRight = tailwindConfig().theme.margin[1]\n              box.style.pointerEvents = 'none'\n              // Label\n              const label = document.createElement('span')\n              label.style.display = 'flex'\n              label.style.alignItems = 'center'\n              const labelText = document.createTextNode(item.text)\n              label.appendChild(labelText)\n              li.appendChild(button)\n              button.appendChild(box)\n              button.appendChild(label)\n              ul.appendChild(li)\n            })\n          },\n        }],        \n      })\n    })\n\n    onUnmounted(() => chart.destroy())\n\n    watch(\n      () => darkMode.value,\n      () => {\n        if (darkMode.value) {\n          chart.options.plugins.tooltip.titleColor = tooltipTitleColor.dark\n          chart.options.plugins.tooltip.bodyColor = tooltipBodyColor.dark\n          chart.options.plugins.tooltip.backgroundColor = tooltipBgColor.dark\n          chart.options.plugins.tooltip.borderColor = tooltipBorderColor.dark\n        } else {\n          chart.options.plugins.tooltip.titleColor = tooltipTitleColor.light\n          chart.options.plugins.tooltip.bodyColor = tooltipBodyColor.light\n          chart.options.plugins.tooltip.backgroundColor = tooltipBgColor.light\n          chart.options.plugins.tooltip.borderColor = tooltipBorderColor.light\n        }\n        chart.update('none')\n      })         \n\n    return {\n      canvas,\n      legend,\n    }\n  }\n}\n</script>"],"names":["Chart","DoughnutController","ArcElement","TimeScale","Tooltip","_sfc_main","props","canvas","ref","legend","chart","darkMode","useDark","tooltipTitleColor","tooltipBodyColor","tooltipBgColor","tooltipBorderColor","chartColors","onMounted","ctx","args","options","ul","item","li","tailwindConfig","button","box","label","labelText","onUnmounted","watch","_hoisted_1","_hoisted_2","_hoisted_3","_openBlock","_createElementBlock","_createElementVNode","$props","_hoisted_4"],"mappings":"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"}